# 朝日新聞信用組合利用者番号入力ツール

朝日新聞信用組合のログイン時に入力を求められる特定桁数の利用者番号を自動入力するChrome拡張機能。

**対象サイト**: `https://www.parasol.anser.ne.jp/ib/BLI001Dispatch`

この拡張機能は、指定された URL でのみ動作するように設定されています。

## プロジェクト構造

```
├── manifest.json          # 拡張機能のマニフェストファイル
├── popup.html            # ポップアップ画面のHTML
├── popup.css             # ポップアップ画面のスタイル
├── popup.js              # ポップアップ画面のJavaScript
├── content.js            # コンテンツスクリプト
├── background.js         # バックグラウンドスクリプト（Service Worker）
├── options.html          # 設定画面のHTML
├── options.css           # 設定画面のスタイル
├── options.js            # 設定画面のJavaScript
├── icons/                # アイコンファイル用ディレクトリ
│   ├── icon16.png
│   ├── icon48.png
│   └── icon128.png
└── README.md             # このファイル
```

## 機能

- **対象サイト限定**: 指定された URL でのみ動作
- **ポップアップ UI**: 美しいモダンなデザインのポップアップ画面
- **設定画面**: 利用者番号やその他の設定を管理する専用画面
- **コンテンツスクリプト**: 対象サイト上での動作と UI 要素の挿入
- **バックグラウンド処理**: Service Worker によるバックグラウンド処理
- **設定管理**: Chrome Storage API を使用した設定の保存・読み込み
- **メッセージ通信**: 各コンポーネント間のメッセージ通信
- **利用者番号管理**: 利用者番号の保存・表示・利用機能
- **桁数抽出機能**: ページから桁数を抽出し、利用者番号から対応する文字をクリップボードにコピー

## 対象サイト

この拡張機能は以下の URL でのみ動作します：

```
https://www.parasol.anser.ne.jp/ib/BLI001Dispatch*
```

- 対象サイト以外では、コンテンツスクリプトは実行されません
- ポップアップ画面は常に利用可能です
- 設定画面は常に利用可能です

## 設定機能

### 利用者番号の管理

- 設定画面で利用者番号を入力・保存
- ポップアップ画面で現在の利用者番号を表示
- 対象サイトでアクション実行時に利用者番号を含めて処理
- 対象サイト上で利用者番号を表示

### 桁数抽出機能

- ページから「○ 桁目」という形式の桁数を自動抽出
- 保存された利用者番号から対応する桁数の文字を取得
- すべての桁数をまとめてクリップボードにコピー
- 個別の桁数をクリップボードにコピー
- 対象サイト上に専用の UI を表示

### その他の設定項目

- **カスタム設定**: 任意の設定値を保存
- **自動実行**: 対象サイト読み込み時の自動アクション実行
- **通知表示**: アクション実行時の通知表示設定

## セットアップ手順

### 1. Chrome 拡張機能として読み込み

1. Chrome ブラウザで `chrome://extensions/` を開く
2. 右上の「デベロッパーモード」を有効にする
3. 「パッケージ化されていない拡張機能を読み込む」をクリック
4. このプロジェクトのディレクトリを選択

### 2. 設定画面へのアクセス

- **ポップアップから**: ポップアップ画面の「設定画面を開く」ボタンをクリック
- **拡張機能管理から**: 拡張機能の詳細ページで「拡張機能のオプション」をクリック

### 3. 対象サイトでの動作確認

1. 対象サイト（`https://www.parasol.anser.ne.jp/ib/BLI001Dispatch`）にアクセス
2. ページ上に利用者番号が表示されることを確認
3. 拡張機能の UI が表示されることを確認
4. 桁数抽出ツールが表示されることを確認

### 4. 桁数抽出機能の使用方法

1. 設定画面で利用者番号を入力・保存
2. 対象サイトにアクセス
3. ページ上に「利用者番号抽出ツール」が表示されます
4. 「すべてコピー」ボタンで対応する文字をまとめてコピー
5. 「個別コピー」ボタンで各桁数の文字を個別にコピー

### 5. 開発・デバッグ

- **ポップアップのデバッグ**: 拡張機能のアイコンを右クリック → 「検証」を選択
- **設定画面のデバッグ**: 設定画面を開いた状態で右クリック → 「検証」を選択
- **コンテンツスクリプトのデバッグ**: 対象サイトの開発者ツールで確認
- **バックグラウンドスクリプトのデバッグ**: 拡張機能の管理ページで「Service Worker」をクリック

## カスタマイズ方法

### 対象 URL の変更

`manifest.json` の `content_scripts` セクションで `matches` を編集：

```json
{
  "content_scripts": [
    {
      "matches": ["https://your-target-site.com/*"],
      "js": ["content.js"]
    }
  ]
}
```

また、`content.js` と `background.js` の `TARGET_URL` 定数も更新してください。

### 拡張機能の名前と説明を変更

`manifest.json` の以下の項目を編集：

```json
{
  "name": "あなたの拡張機能名",
  "description": "拡張機能の説明"
}
```

### 権限の追加

`manifest.json` の `permissions` 配列に必要な権限を追加：

```json
{
  "permissions": ["activeTab", "storage", "tabs", "notifications"]
}
```

### 設定項目の追加

`options.js` で新しい設定項目を追加：

```javascript
// 新しい設定項目の読み込み
const result = await chrome.storage.sync.get(["newSetting"]);

// 新しい設定項目の保存
await chrome.storage.sync.set({ newSetting: value });
```

### 桁数抽出パターンの変更

`content.js` の `extractDigitsFromPage` 関数で正規表現パターンを変更：

```javascript
// 現在のパターン: /(\d+)桁目/g
// 新しいパターンに変更可能
const digitPattern = /(\d+)桁目/g;
```
